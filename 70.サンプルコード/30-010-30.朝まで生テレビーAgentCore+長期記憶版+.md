

AWS Bedrock AgentCoreにおける**Long-term memory（長期記憶 / LTM）**は、セッションを跨いでユーザーの好みや重要な事実を保持し、エージェントを「一回限りの使い捨て」から「ユーザーと共に成長するパートナー」へ進化させるための基盤です。

短期記憶（STM）が「会話ログの生データ」を扱うのに対し、長期記憶はそこから**「インサイト（価値ある情報）」を蒸留して蓄積**します。

---

# 概要

AgentCoreのLTMは、単一の箱ではありません。`MemoryId`（Namespace）をパス構造のように設計することで、**「消えない知識（Actor単位）」**と**「特定の振り返り（Session単位）」**　を使い分けることが可能です。

これにより、アリスさんの知識がボブさんに漏れることを防ぎつつ（Actor ID分離）、アリスさん自身も「昨日何を学んだか」をセッション単位で整理されたサマリーから参照できるようになります。

AgentCoreの長期記憶（LTM）におけるNamespace設計の肝は、**「誰の(Actor)」** 情報を**「どの粒度(Scope)」**で保持するかをパス構造で定義することです。

- **Actor IDによる分離:** ユーザー間のデータ混ざりを物理的に防止。
    
- **Namespaceによる役割分担:** 永続的な「知識・傾向」と、一過性の「セッションサマリー」を切り分ける。
    

# 実装のポイント

- [[30-010-20.朝まで生テレビーAgentCore+短期記憶版+]]で説明するメモリに対して長期記憶を設定を追加するのみです。
- 
# Namespace設計の定義と活用例

今回の技術学習アシスタントにおける設計を整理します。

| **カテゴリ** | **Namespace (Memory ID) の構成**                   | **保持するインサイト**      | **検索時のメリット**          |
| -------- | ----------------------------------------------- | ------------------ | --------------------- |
| **技術知識** | `tech_learning/knowledge/{actorId}`             | 習得済みスキル、苦手な概念      | 重複説明を避け、最適な難易度を提供     |
| **学習傾向** | `tech_learning/preferences/{actorId}`           | 好みの説明スタイル、集中できる時間帯 | 回答のトーンや形式（図解多用など）を最適化 |
| **サマリー** | `tech_learning/summaries/{actorId}/{sessionId}` | その回の到達点、宿題、未解決事項   | 「前回の続きから」という指示に即座に対応  |

---
# プロビジョニング

### 作成開始

Amazon Bedrock AgentCore.Memoryで`My Memory ID`を選択し、`Edit`をクリックします。

-  **MemoryId: memory_masoy-2JQxnf4Pnc
- **Long-term memory extraction strategies:
- **Built-in strategies: Summarization
	- **Strategy name: summary_builtin_lodbf
	- **Namespace: /strategies/{memoryStrategyId}/actors/{actorId}/sessions/{sessionId}

[ネームスペースガイド]
```
名前空間を論理的に整理するには、スラッシュ (/) で区切られた階層形式を使用します。以下の定義済み変数を含めることができます。

- {actorId} - CreateEvent APIで作成されるユーザー識別子
- {memoryStrategyId} - 抽出戦略の識別子
- {sessionId} - 各セッションの識別子

**例示:**
/actors/{actorId}/strategies/{memoryStrategyId}/sessions/{sessionId}
メモリ作成後、この名前空間は次のようになります:
/actor/actor-dw5zuaHwP2/strategy/summarization-fy5ziaKwC2/session/session-ga7ipaHwV8
```

- **Create memory**

これで長期記憶の抽出は開始されます。

# サンプルコード

長期記憶の抽出は、別途コーディング不要です。


