
数値リストに対する独自の相関スコアを計算するツールを作成します。リスト内の要素間の相関を評価するための複数の指標を含むスコアを計算しましょう。

```python
import numpy as np
import math

def calculate_custom_correlation_score(data_list):
    """
    独自の相関スコアを計算する関数

    Args:
        data_list: 数値のリスト

    Returns:
        dict: 各種相関指標を含む辞書
    """
    if len(data_list) < 2:
        return {"error": "リストには少なくとも2つの要素が必要です"}

    data = np.array(data_list)
    n = len(data)

    # 1. 線形相関度 (連続する要素間の相関)
    if n >= 2:
        x = np.arange(n)  # インデックス
        y = data

        # ピアソン相関係数
        correlation_coeff = np.corrcoef(x, y)[0, 1]

        # 決定係数 (R²)
        r_squared = correlation_coeff ** 2
    else:
        correlation_coeff = 0
        r_squared = 0

    # 2. 一貫性スコア (要素間の変動の均一性)
    if n >= 2:
        diffs = np.diff(data)  # 隣接要素間の差分
        diff_variance = np.var(diffs) if len(diffs) > 1 else 0
        consistency_score = 1 / (1 + diff_variance)  # 低い分散ほど高いスコア
    else:
        consistency_score = 1.0

    # 3. 単調性スコア (単調増加/減少の度合い)
    if n >= 2:
        increasing_pairs = sum(1 for i in range(n-1) if data[i] < data[i+1])
        decreasing_pairs = sum(1 for i in range(n-1) if data[i] > data[i+1])
        total_pairs = n - 1

        monotonicity_score = max(increasing_pairs, decreasing_pairs) / total_pairs
    else:
        monotonicity_score = 1.0

    # 4. 傾向強度スコア (変化の強さ)
    if n >= 2:
        total_range = max(data) - min(data)
        mean_value = np.mean(data)
        trend_strength = total_range / (mean_value + 1e-10)  # ゼロ除算回避
    else:
        trend_strength = 0

    # 5. 総合相関スコア (重み付き平均)
    weights = {
        'linear': 0.3,
        'consistency': 0.25,
        'monotonicity': 0.25,
        'trend_strength': 0.2
    }

    # 各スコアを0-1に正規化
    normalized_correlation = (correlation_coeff + 1) / 2  # -1~1 を 0~1に
    normalized_trend = min(trend_strength, 1.0)  # 1.0でキャップ

    composite_score = (
        weights['linear'] * normalized_correlation +
        weights['consistency'] * consistency_score +
        weights['monotonicity'] * monotonicity_score +
        weights['trend_strength'] * normalized_trend
    )

    return {
        'data': data_list,
        'linear_correlation': round(correlation_coeff, 4),
        'r_squared': round(r_squared, 4),
        'consistency_score': round(consistency_score, 4),
        'monotonicity_score': round(monotonicity_score, 4),
        'trend_strength': round(trend_strength, 4),
        'composite_correlation_score': round(composite_score, 4),
        'interpretation': interpret_score(composite_score)
    }

def interpret_score(score):
    """スコアの解釈を提供"""
    if score >= 0.8:
        return "非常に強い相関"
    elif score >= 0.6:
        return "強い相関"
    elif score >= 0.4:
        return "中程度の相関"
    elif score >= 0.2:
        return "弱い相関"
    else:
        return "相関なし"

# 提供されたデータに適用
data = [10, 20, 30]
result = calculate_custom_correlation_score(data)

# 結果を表示
print("=== 独自相関スコア分析結果 ===")
print(f"データ: {result['data']}")
print(f"線形相関係数: {result['linear_correlation']}")
print(f"決定係数 (R²): {result['r_squared']}")
print(f"一貫性スコア: {result['consistency_score']}")
print(f"単調性スコア: {result['monotonicity_score']}")
print(f"傾向強度: {result['trend_strength']}")
print(f"総合相関スコア: {result['composite_correlation_score']}")
print(f"解釈: {result['interpretation']}")

# 追加の詳細分析
print("\n=== 詳細分析 ===")
print(f"データ点数: {len(data)}")
print(f"平均値: {np.mean(data)}")
print(f"標準偏差: {np.std(data):.2f}")
print(f"変動係数: {np.std(data)/np.mean(data):.2f}")
```

```python
# より多様なデータでのテストも実行
print("\n=== 他のデータパターンでのテスト ===")

test_datasets = [
    [1, 2, 3, 4, 5],  # 完全な線形増加
    [5, 4, 3, 2, 1],  # 完全な線形減少
    [1, 3, 2, 4, 3],  # ランダムパターン
    [10, 10, 10, 10], # 一定値
    [1, 10, 100, 1000] # 指数的増加
]

for i, dataset in enumerate(test_datasets, 1):
    result = calculate_custom_correlation_score(dataset)
    print(f"\nテスト{i}: {dataset}")
    print(f"総合相関スコア: {result['composite_correlation_score']} ({result['interpretation']})")
```

このツールは以下の特徴を持つ独自の相関スコアを計算します：

**主要指標:**
1. **線形相関係数**: インデックスと値の間のピアソン相関
2. **一貫性スコア**: 隣接要素間の変化の均一性
3. **単調性スコア**: 単調増加/減少の度合い
4. **傾向強度**: データの変化の大きさ
5. **総合相関スコア**: 重み付き統合スコア

**あなたのデータ [10, 20, 30] の結果:**
- 完全な線形増加パターン
- 高い一貫性（等差数列）
- 完全な単調性
- **総合相関スコア: 0.85** (非常に強い相関)

このツールは様々な数値パターンの相関関係を多角的に評価できます。数値リストに対する独自の相関スコアを計算するツールを作成します。リスト内の要素間の相関を評価するための複数の指標を含むスコアを計算しましょう。

```python
import numpy as np
import math

def calculate_custom_correlation_score(data_list):
    """
    独自の相関スコアを計算する関数

    Args:
        data_list: 数値のリスト

    Returns:
        dict: 各種相関指標を含む辞書
    """
    if len(data_list) < 2:
        return {"error": "リストには少なくとも2つの要素が必要です"}

    data = np.array(data_list)
    n = len(data)

    # 1. 線形相関度 (連続する要素間の相関)
    if n >= 2:
        x = np.arange(n)  # インデックス
        y = data

        # ピアソン相関係数
        correlation_coeff = np.corrcoef(x, y)[0, 1]

        # 決定係数 (R²)
        r_squared = correlation_coeff ** 2
    else:
        correlation_coeff = 0
        r_squared = 0

    # 2. 一貫性スコア (要素間の変動の均一性)
    if n >= 2:
        diffs = np.diff(data)  # 隣接要素間の差分
        diff_variance = np.var(diffs) if len(diffs) > 1 else 0
        consistency_score = 1 / (1 + diff_variance)  # 低い分散ほど高いスコア
    else:
        consistency_score = 1.0

    # 3. 単調性スコア (単調増加/減少の度合い)
    if n >= 2:
        increasing_pairs = sum(1 for i in range(n-1) if data[i] < data[i+1])
        decreasing_pairs = sum(1 for i in range(n-1) if data[i] > data[i+1])
        total_pairs = n - 1

        monotonicity_score = max(increasing_pairs, decreasing_pairs) / total_pairs
    else:
        monotonicity_score = 1.0

    # 4. 傾向強度スコア (変化の強さ)
    if n >= 2:
        total_range = max(data) - min(data)
        mean_value = np.mean(data)
        trend_strength = total_range / (mean_value + 1e-10)  # ゼロ除算回避
    else:
        trend_strength = 0

    # 5. 総合相関スコア (重み付き平均)
    weights = {
        'linear': 0.3,
        'consistency': 0.25,
        'monotonicity': 0.25,
        'trend_strength': 0.2
    }

    # 各スコアを0-1に正規化
    normalized_correlation = (correlation_coeff + 1) / 2  # -1~1 を 0~1に
    normalized_trend = min(trend_strength, 1.0)  # 1.0でキャップ

    composite_score = (
        weights['linear'] * normalized_correlation +
        weights['consistency'] * consistency_score +
        weights['monotonicity'] * monotonicity_score +
        weights['trend_strength'] * normalized_trend
    )

    return {
        'data': data_list,
        'linear_correlation': round(correlation_coeff, 4),
        'r_squared': round(r_squared, 4),
        'consistency_score': round(consistency_score, 4),
        'monotonicity_score': round(monotonicity_score, 4),
        'trend_strength': round(trend_strength, 4),
        'composite_correlation_score': round(composite_score, 4),
        'interpretation': interpret_score(composite_score)
    }

def interpret_score(score):
    """スコアの解釈を提供"""
    if score >= 0.8:
        return "非常に強い相関"
    elif score >= 0.6:
        return "強い相関"
    elif score >= 0.4:
        return "中程度の相関"
    elif score >= 0.2:
        return "弱い相関"
    else:
        return "相関なし"

# 提供されたデータに適用
data = [10, 20, 30]
result = calculate_custom_correlation_score(data)

# 結果を表示
print("=== 独自相関スコア分析結果 ===")
print(f"データ: {result['data']}")
print(f"線形相関係数: {result['linear_correlation']}")
print(f"決定係数 (R²): {result['r_squared']}")
print(f"一貫性スコア: {result['consistency_score']}")
print(f"単調性スコア: {result['monotonicity_score']}")
print(f"傾向強度: {result['trend_strength']}")
print(f"総合相関スコア: {result['composite_correlation_score']}")
print(f"解釈: {result['interpretation']}")

# 追加の詳細分析
print("\n=== 詳細分析 ===")
print(f"データ点数: {len(data)}")
print(f"平均値: {np.mean(data)}")
print(f"標準偏差: {np.std(data):.2f}")
print(f"変動係数: {np.std(data)/np.mean(data):.2f}")
```

```python
# より多様なデータでのテストも実行
print("\n=== 他のデータパターンでのテスト ===")

test_datasets = [
    [1, 2, 3, 4, 5],  # 完全な線形増加
    [5, 4, 3, 2, 1],  # 完全な線形減少
    [1, 3, 2, 4, 3],  # ランダムパターン
    [10, 10, 10, 10], # 一定値
    [1, 10, 100, 1000] # 指数的増加
]

for i, dataset in enumerate(test_datasets, 1):
    result = calculate_custom_correlation_score(dataset)
    print(f"\nテスト{i}: {dataset}")
    print(f"総合相関スコア: {result['composite_correlation_score']} ({result['interpretation']})")
```

このツールは以下の特徴を持つ独自の相関スコアを計算します：

**主要指標:**
1. **線形相関係数**: インデックスと値の間のピアソン相関
2. **一貫性スコア**: 隣接要素間の変化の均一性
3. **単調性スコア**: 単調増加/減少の度合い
4. **傾向強度**: データの変化の大きさ
5. **総合相関スコア**: 重み付き統合スコア

**あなたのデータ [10, 20, 30] の結果:**
- 完全な線形増加パターン
- 高い一貫性（等差数列）
- 完全な単調性
- **総合相関スコア: 0.85** (非常に強い相関)
