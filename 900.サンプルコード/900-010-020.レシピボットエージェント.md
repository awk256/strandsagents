
# æ¦‚è¦

ã“ã®ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€**æ–™ç†ã®ãƒ¬ã‚·ãƒ”ã‚’èã‹ã‚Œã‚‹ã¨ã€ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‹ã‚‰æ¤œç´¢ã—ã¦å›ç­”ã—ã¦ãã‚Œã‚‹ä»•çµ„ã¿**ã«ãªã£ã¦ã„ã¾ã™ã€‚  
å¤–éƒ¨æ¤œç´¢ã«ã¯ã€**DDGSï¼ˆDuckDuckGo Searchï¼‰** ã‚’åˆ©ç”¨ã—ã¦ãŠã‚Šã€æ¤œç´¢ã‚¨ãƒ³ã‚¸ãƒ³ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹ã‚’æ‹…å½“ã™ã‚‹ãƒ„ãƒ¼ãƒ«ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚

ãƒã‚¤ãƒ³ãƒˆã¯ã€**ãŸã ã®ã‚·ãƒ³ãƒ—ãƒ«ãªã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã¯ãªãã€ãƒ¬ã‚·ãƒ”æƒ…å ±ã‚’ãƒãƒƒãƒˆæ¤œç´¢ã«ã‚ˆã£ã¦å–å¾—ã—ã¦ã„ã‚‹**ã¨ã„ã†ç‚¹ã§ã™ã€‚  
ã“ã®æ¤œç´¢ã®ãŸã‚ã«ã€**LLM ã‚’è£œåŠ©ã™ã‚‹ã€Œãƒ„ãƒ¼ãƒ«ï¼ˆToolï¼‰ã€ã‚’æ´»ç”¨**ã—ã¦ãŠã‚Šã€å¿…è¦ã«å¿œã˜ã¦æ¤œç´¢æ©Ÿèƒ½ã‚’å‘¼ã³å‡ºã—ã¾ã™ã€‚

Strands ã«ãŠã‘ã‚‹ãƒ„ãƒ¼ãƒ«ã®å®£è¨€ã¯éå¸¸ã«ç°¡å˜ã§ã€**ãƒ¡ã‚½ãƒƒãƒ‰ã« `@tool` ãƒ‡ã‚³ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ä»˜ã‘ã‚‹ã ã‘**ã€‚  
ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€ãƒ„ãƒ¼ãƒ«ã®èª¬æ˜ï¼ˆdocstringï¼‰ã‚’ã‚‚ã¨ã«ã€**ãã®ä½¿ç”¨ãŒå¿…è¦ã‹ã©ã†ã‹ã‚’è‡ªå¾‹çš„ã«åˆ¤æ–­**ã—ã¾ã™ã€‚

ã“ã®ã‚ˆã†ãªæ§‹æˆã¯ã€**ã€ŒTool Useï¼ˆReActï¼‰ã€ãƒ‘ã‚¿ãƒ¼ãƒ³**ã¨å‘¼ã°ã‚Œã€å˜ãªã‚‹ãƒ†ã‚­ã‚¹ãƒˆç”Ÿæˆã§ã¯ãªãã€  **å¿…è¦ã«å¿œã˜ã¦å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã„åˆ†ã‘ã€ãã®çµæœã‚’çµ±åˆã—ã¦è¿”ç­”ã™ã‚‹ä»•çµ„ã¿**ã«ãªã£ã¦ã„ã¾ã™ã€‚

>ã“ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã¯ã€**ã€Œè„³ï¼ˆLLMï¼‰ã€ãƒ»ã€Œé“å…·ï¼ˆToolï¼‰ã€ãƒ»ã€Œè¨˜æ†¶ï¼ˆSessionï¼‰ã€**ã€€ã¨ã„ã†3å¤§è¦ç´ ã‚’å‚™ãˆã¦ã„ã‚‹ã‚·ãƒ³ã‚°ãƒ«ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã®ä»£è¡¨çš„ãªä¾‹ã§ã™ã€‚


```mermaid
sequenceDiagram
    autonumber
    actor User as ãƒ¦ãƒ¼ã‚¶ãƒ¼
    participant Agent as RecipeBot<br/>(System Promptè¾¼ã¿)
    participant Claude as Claude 4 Sonnet<br/>(LLM)
    participant Tool as websearch tool<br/>(DuckDuckGo)

    User->>Agent: å…¥åŠ›: ã€Œå†·è”µåº«ã®åµã§ä½•ãŒä½œã‚Œã‚‹ï¼Ÿã€
    
    rect rgb(255, 243, 224)
        Note over Agent, Claude: æ€è€ƒãƒ»å®Ÿè¡Œãƒ«ãƒ¼ãƒ— (ReAct)
        Agent->>Claude: æ€è€ƒ(Thought): æ¤œç´¢ãŒå¿…è¦ã‹åˆ¤æ–­ä¾é ¼
        Claude-->>Agent: ã€Œæœ€æ–°ã®ãƒˆãƒ¬ãƒ³ãƒ‰ãƒ¬ã‚·ãƒ”ã‚’æ¤œç´¢ã—ã¦ãã ã•ã„ã€
    end

    alt ãƒ„ãƒ¼ãƒ«ãŒå¿…è¦ãªå ´åˆ (YES)
        Agent->>Tool: DuckDuckGo API ã§æ¤œç´¢å®Ÿè¡Œ
        Tool-->>Agent: æ¤œç´¢çµæœ (Webã®æœ€æ–°æƒ…å ±)
    end

    rect rgb(255, 243, 224)
        Agent->>Claude: çµ±åˆ(Synthesis): æ¤œç´¢çµæœã«åŸºã¥ãå›ç­”ä½œæˆ
        Claude-->>Agent: å®Œæˆã—ãŸãƒ¬ã‚·ãƒ”å›ç­”
    end

    Agent->>User: å›ç­”: ã€Œåµã§ä½œã‚‹ãƒ¬ã‚·ãƒ”ã¯ã“ã¡ã‚‰...ã€
```



#### å°‚é–€å®¶ã¨ã—ã¦ã®æ§‹ãˆ (System Prompt)

ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®å…¥åŠ›ã«å¯¾ã—ã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã¯ã€Œã‚ãªãŸã¯ã‚«ãƒªã‚¹ãƒæ–™ç†ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã§ã™ã€ã¨ã„ã†**å½¹å‰²è¨­å®šï¼ˆSystem Promptï¼‰**ã«åŸºã¥ã„ãŸæ€è€ƒã‚’é–‹å§‹ã—ã¾ã™ã€‚

#### åˆ¤æ–­ã¨æ¤œç´¢ (Reasoning & Tool Use)

ã“ã“ãŒæœ€ã‚‚è³¢ã„éƒ¨åˆ†ã§ã™ã€‚AIï¼ˆClaudeï¼‰ãŒç¾åœ¨ã®çŸ¥è­˜ã ã‘ã§ç­”ãˆã‚‹ã‹ã€å¤–ã®ä¸–ç•Œã®æƒ…å ±ã‚’èª¿ã¹ã‚‹ã¹ãã‹ã‚’**åˆ¤æ–­ï¼ˆDecisionï¼‰**ã—ã¾ã™ã€‚

- æ¤œç´¢ãŒå¿…è¦ã¨åˆ¤æ–­ã™ã‚Œã°ã€**websearch tool**ã‚’ä½¿ã£ã¦ãƒãƒƒãƒˆã‹ã‚‰æœ€æ–°ã®åµæ–™ç†ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’æ‹¾ã£ã¦ãã¾ã™ã€‚

#### æƒ…å ±ã®çµ±åˆã¨å›ç­” (Synthesis)

é›†ã‚ã¦ããŸç”Ÿã®æ¤œç´¢çµæœã¨AIã®çŸ¥è­˜ã‚’çµ„ã¿åˆã‚ã›ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒèª­ã¿ã‚„ã™ã„å½¢ã«**ã¾ã¨ã‚ä¸Šã’ï¼ˆSynthesisï¼‰**ã€æœ€çµ‚çš„ãªãƒ¬ã‚·ãƒ”ææ¡ˆã¨ã—ã¦å›ç­”ã—ã¾ã™ã€‚


# ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰

[recipe_bot.py]
```
# Import Agent and tools
import logging
import json
from ddgs import DDGS
from ddgs.exceptions import DDGSException, RatelimitException
from strands import Agent, tool

# Configure logging
logging.getLogger("strands").setLevel(
    logging.INFO
)  # Set to DEBUG for more detailed logs


# Define a websearch tool
@tool
def websearch(
    keywords: str, region: str = "us-en", max_results: int = 5
) -> str:
    """æœ€æ–°æƒ…å ±ã‚’å–å¾—ã™ã‚‹ã«ã¯ã€Web ã‚’æ¤œç´¢ã—ã¦ãã ã•ã„ã€‚
    Args:
        keywords: æ¤œç´¢ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã€‚
        region: æ¤œç´¢åœ°åŸŸ: wt-wt, us-en, uk-en, ru-ru ãªã©ã€‚
        max_results: è¿”ã™çµæœã®æœ€å¤§æ•°ã€‚
    Returns:
        JSONæ–‡å­—åˆ—å½¢å¼ã®æ¤œç´¢çµæœã€‚
    """
    try:
        results = DDGS().text(keywords, region=region, max_results=max_results)
        return json.dumps(results, ensure_ascii=False) if results else "çµæœãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚"
    except RatelimitException:
        return "ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚¨ãƒ©ãƒ¼: ã—ã°ã‚‰ãå¾…ã£ã¦ã‹ã‚‰å†è©¦è¡Œã—ã¦ãã ã•ã„ã€‚"
    except DDGSException as d:
        return f"DuckDuckGoæ¤œç´¢ã‚¨ãƒ©ãƒ¼: {d}"
    except Exception as e:
        return f"ã‚¨ãƒ©ãƒ¼: {e}"
from strands.models.bedrock import BedrockModel
bedrock_model = BedrockModel(
    region_name="us-east-1",
    model_id="us.anthropic.claude-sonnet-4-20250514-v1:0",
    # callback_handler=None,
)

# Create a recipe assistant agent
recipe_agent = Agent(
    model=bedrock_model,
    system_prompt="""ã‚ãªãŸã¯ã€ã‚«ãƒªã‚¹ãƒã®æ–™ç†ã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã€ŒRecipeBotã€ã§ã™ã€‚
    ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé£Ÿæã«åŸºã¥ã„ã¦ãƒ¬ã‚·ãƒ”ã‚’æ¤œç´¢ã—ãŸã‚Šã€æ–™ç†ã«é–¢ã™ã‚‹è³ªå•ã«ç­”ãˆãŸã‚Šã§ãã‚‹ã‚ˆã†ã‚µãƒãƒ¼ãƒˆã—ã¾ã™ã€‚
    ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒé£Ÿæã«ã¤ã„ã¦è¨€åŠã—ãŸã¨ãã«ãƒ¬ã‚·ãƒ”ã‚’æ¤œç´¢ã—ãŸã‚Šã€æ–™ç†æƒ…å ±ã‚’èª¿ã¹ãŸã‚Šã™ã‚‹ã«ã¯ã€ã‚¦ã‚§ãƒ–æ¤œç´¢ãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚""",
    tools=[websearch],
)

#system_prompt="""You are RecipeBot, a helpful cooking assistant.
#    Help users find recipes based on ingredients and answer cooking questions.
#    Use the websearch tool to find recipes when users mention ingredients or to look up cooking information.""",


if __name__ == "__main__":
    print("\nğŸ‘¨â€ğŸ³ RecipeBot: ãƒ¬ã‚·ãƒ”ã‚„æ–™ç†ã«ã¤ã„ã¦èã„ã¦ãã ã•ã„ï¼çµ‚äº†ã™ã‚‹ã«ã¯ã€Œexitã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚\n")

    # Run the agent in a loop for interactive conversation
    while True:
        user_input = input("\nYou > ")
        if user_input.lower() == "exit":
            print("Happy cooking! ğŸ½ï¸")
            break
        response = recipe_agent(user_input)
        print(f"\nRecipeBot > {response}")
        
```


# å®Ÿè¡Œ

```
uv pip install ddgs
```

```
python recipe_bot.py

ğŸ‘¨â€ğŸ³ RecipeBot: ãƒ¬ã‚·ãƒ”ã‚„æ–™ç†ã«ã¤ã„ã¦èã„ã¦ãã ã•ã„ï¼çµ‚äº†ã™ã‚‹ã«ã¯ã€Œexitã€ã¨å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚


You > åµã§ãã‚‹æ–™ç†ã¯
åµã‚’ä½¿ã£ãŸæ–™ç†ã®ãƒ¬ã‚·ãƒ”ã‚’æ¤œç´¢ã—ã¦ã¿ã¾ã™ã­ï¼
Tool #1: websearch
æ¤œç´¢ãŒã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆã—ã¦ã—ã¾ã„ã¾ã—ãŸã€‚åˆ¥ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§å†åº¦æ¤œç´¢ã—ã¦ã¿ã¾ã™ã­ã€‚
Tool #2: websearch
åµã§ä½œã‚Œã‚‹æ–™ç†ã¯ãŸãã•ã‚“ã‚ã‚Šã¾ã™ã­ï¼æ¤œç´¢çµæœã‹ã‚‰ã€äººæ°—ã®åµæ–™ç†ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã­ï¼š

## ğŸ¥š åµã§ä½œã‚Œã‚‹äººæ°—æ–™ç† ğŸ¥š

### **åŸºæœ¬ã®åµæ–™ç†**
- **åµç„¼ã** - ãŠå¼å½“ã®å®šç•ªã€ç”˜ã„å‡ºæ±å·»ãåµã‚‚
- **ã‚ªãƒ ãƒ¬ãƒ„** - ãƒ—ãƒ¬ãƒ¼ãƒ³ã‹ã‚‰ãƒãƒ¼ã‚ºå…¥ã‚Šã¾ã§
- **ç›®ç‰ç„¼ã** - ã‚·ãƒ³ãƒ—ãƒ«ã§æœé£Ÿã«ã´ã£ãŸã‚Š
- **ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«ã‚¨ãƒƒã‚°** - ãµã‚ãµã‚ã§å„ªã—ã„å‘³

### **ã”é£¯ã‚‚ã®**
- **åµãƒãƒ£ãƒ¼ãƒãƒ³** - ãƒ‘ãƒ©ãƒ‘ãƒ©ã«ä»•ä¸Šã’ã‚‹ã‚³ãƒ„ãŒå¤§åˆ‡
- **åµé›‘ç‚Š** - ä½“èª¿ãŒæ‚ªã„æ™‚ã«ã‚‚å„ªã—ã„
- **ç›®ç‰ç„¼ãã”é£¯** - ç°¡å˜ã§æº€è¶³æ„ŸãŸã£ã·ã‚Š

### **ãŠã‹ãšã«ãªã‚‹åµæ–™ç†**
- **ã‚ã‚“ã‹ã‘ãƒ‹ãƒ©ç‰** - ã¨ã‚ã€œã‚Šã‚ã‚“ãŒãŠã„ã—ã„
- **ç…®åµ** - ãƒ©ãƒ¼ãƒ¡ãƒ³ã®ãƒˆãƒƒãƒ”ãƒ³ã‚°ã«ã‚‚
- **åµã®ã‚µãƒ©ãƒ€** - ãƒãƒ¨ãƒãƒ¼ã‚ºã¨åˆã‚ã›ã¦
- **èŒ¶ç¢—è’¸ã—** - ä¸Šå“ãªè’¸ã—æ–™ç†

### **ãã®ä»–ã®ã‚¢ãƒ¬ãƒ³ã‚¸**
- **åµã®ç‚’ã‚ç‰©** - é‡èœã¨ä¸€ç·’ã«
- **åµå…¥ã‚Šã‚¹ãƒ¼ãƒ—** - ä¸­è¯é¢¨ã‹ãç‰ã‚¹ãƒ¼ãƒ—ãªã©

ä½•ã‹ç‰¹å®šã®åµæ–™ç†ã®ãƒ¬ã‚·ãƒ”ã‚’ãŠçŸ¥ã‚Šã«ãªã‚ŠãŸã„å ´åˆã¯ã€ãŠèã‹ã›ãã ã•ã„ï¼è©³ã—ã„ãƒ¬ã‚·ãƒ”ã‚’èª¿ã¹ã¦ãŠä¼ãˆã—ã¾ã™ ğŸ³
RecipeBot > åµã§ä½œã‚Œã‚‹æ–™ç†ã¯ãŸãã•ã‚“ã‚ã‚Šã¾ã™ã­ï¼æ¤œç´¢çµæœã‹ã‚‰ã€äººæ°—ã®åµæ–™ç†ã‚’ã”ç´¹ä»‹ã—ã¾ã™ã­ï¼š

## ğŸ¥š åµã§ä½œã‚Œã‚‹äººæ°—æ–™ç† ğŸ¥š

### **åŸºæœ¬ã®åµæ–™ç†**
- **åµç„¼ã** - ãŠå¼å½“ã®å®šç•ªã€ç”˜ã„å‡ºæ±å·»ãåµã‚‚
- **ã‚ªãƒ ãƒ¬ãƒ„** - ãƒ—ãƒ¬ãƒ¼ãƒ³ã‹ã‚‰ãƒãƒ¼ã‚ºå…¥ã‚Šã¾ã§
- **ç›®ç‰ç„¼ã** - ã‚·ãƒ³ãƒ—ãƒ«ã§æœé£Ÿã«ã´ã£ãŸã‚Š
- **ã‚¹ã‚¯ãƒ©ãƒ³ãƒ–ãƒ«ã‚¨ãƒƒã‚°** - ãµã‚ãµã‚ã§å„ªã—ã„å‘³

### **ã”é£¯ã‚‚ã®**
- **åµãƒãƒ£ãƒ¼ãƒãƒ³** - ãƒ‘ãƒ©ãƒ‘ãƒ©ã«ä»•ä¸Šã’ã‚‹ã‚³ãƒ„ãŒå¤§åˆ‡
- **åµé›‘ç‚Š** - ä½“èª¿ãŒæ‚ªã„æ™‚ã«ã‚‚å„ªã—ã„
- **ç›®ç‰ç„¼ãã”é£¯** - ç°¡å˜ã§æº€è¶³æ„ŸãŸã£ã·ã‚Š

### **ãŠã‹ãšã«ãªã‚‹åµæ–™ç†**
- **ã‚ã‚“ã‹ã‘ãƒ‹ãƒ©ç‰** - ã¨ã‚ã€œã‚Šã‚ã‚“ãŒãŠã„ã—ã„
- **ç…®åµ** - ãƒ©ãƒ¼ãƒ¡ãƒ³ã®ãƒˆãƒƒãƒ”ãƒ³ã‚°ã«ã‚‚
- **åµã®ã‚µãƒ©ãƒ€** - ãƒãƒ¨ãƒãƒ¼ã‚ºã¨åˆã‚ã›ã¦
- **èŒ¶ç¢—è’¸ã—** - ä¸Šå“ãªè’¸ã—æ–™ç†

### **ãã®ä»–ã®ã‚¢ãƒ¬ãƒ³ã‚¸**
- **åµã®ç‚’ã‚ç‰©** - é‡èœã¨ä¸€ç·’ã«
- **åµå…¥ã‚Šã‚¹ãƒ¼ãƒ—** - ä¸­è¯é¢¨ã‹ãç‰ã‚¹ãƒ¼ãƒ—ãªã©

ä½•ã‹ç‰¹å®šã®åµæ–™ç†ã®ãƒ¬ã‚·ãƒ”ã‚’ãŠçŸ¥ã‚Šã«ãªã‚ŠãŸã„å ´åˆã¯ã€ãŠèã‹ã›ãã ã•ã„ï¼è©³ã—ã„ãƒ¬ã‚·ãƒ”ã‚’èª¿ã¹ã¦ãŠä¼ãˆã—ã¾ã™ ğŸ³


You > exit
Happy cooking! ğŸ½ï¸
```

