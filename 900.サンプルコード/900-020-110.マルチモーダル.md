
# 概要

マルチモーダル（Multimodal） とは、テキスト以外のデータ形式（画像、PDF、ドキュメントファイルなど）をAIエージェントが直接理解し、処理する能力を指します。

Strands SDKでは、Amazon Bedrockなどの強力なマルチモーダルモデルを活用し、エージェントに「画像を見て状況を判断させる」「複雑な図表を含むドキュメントを読み解かせる」といった、視覚的情報を伴う高度な推論タスクをシームレスに実装できます。

```mermaid
sequenceDiagram
    autonumber
    actor User as ユーザー
    participant Agent as Multimodal Agent
    participant Vision as 視覚・文書解析 (Vision/OCR)
    participant Text as 意味理解 (NLP)
    participant Reasoning as 総合判断 (Reasoning)

    User->>Agent: 1. 画像やファイルを添付して依頼
    
    par 同時解析
        Agent->>Text: 2-a. テキストの意味を理解
        Agent->>Vision: 2-b. 画像や図表の特徴を抽出
        Agent->>Vision: 2-c. 文書の構造(レイアウト)を把握
    end

    Text-->>Reasoning: 3. 解析結果を統合
    Vision-->>Reasoning: 4. 解析結果を統合

    Note over Reasoning: 全データ間の相関を推論
    
    Reasoning-->>Agent: 5. 統合された結論
    Agent-->>User: 6. 最終回答
```

#### インプット解析層による情報の専門処理

**Multimodal Agent** は、入力されたデータが「何であるか」を瞬時に判別し、適切な解析エンジンに振り分けます。テキストは文脈を、画像は色や形を、文書は表や配置を、といった具合に、それぞれのデータ形式に最適な手法で「特徴量」を抽出します。

#### 異なる情報の統合推論

このシステムの核心は、バラバラに解析された情報を **統合推論（Reasoning）** のステージで一つに結びつける点にあります。例えば、「この写真の商品の、マニュアルの3ページ目にある使い方を教えて」という依頼に対し、画像の内容と文書の内容を照らし合わせて、矛盾のない答えを導き出します。

#### 視覚とテキストの相関理解

単に画像を見るだけでなく、**Vision** と **Document** の解析を組み合わせることで、グラフの数値や写真の中の文字（OCR）も正確に読み取ります。これにより、人間が目で見て理解するのと同等の「マルチモーダルな文脈理解」を AI がエージェントとして実行できるようになります。

# サンプルコード

画像とテキストを同時にエージェントに渡し、内容を分析させる実装例です。

[multi_modal.py]
```
from strands import Agent
from strands.types.content import ContentBlock
from strands.models import BedrockModel
from pathlib import Path

model = BedrockModel(model_id="us.anthropic.claude-sonnet-4-20250514-v1:0")

# 1. マルチモーダル対応エージェントの構築
agent = Agent(
    model=model,
    system_prompt="あなたは画像やドキュメントを精密に分析する専門家です。"
)

# 2. データの準備
image_path = Path("Strands Agents with AWS services.png")
with open(image_path, "rb") as f:
    image_data = f.read()

# テキストと画像を ContentBlock のリストとして構成
input_content = [
    ContentBlock(text="この構成図におけるセキュリティ上の懸念点を抽出してください。"),
    ContentBlock(image={"format": "png", "source": {"bytes": image_data}})
]

# 3. 実行
response = agent(input_content)
print("--- 解析結果 ---")
print(response.message["content"][0]["text"])


```

<img src="../images/strands_agents_with_aws_services.png" width="800" alt="記憶戦略と抽出戦略">

# 実行

```
python multi_modal.py

この構成図を分析して、以下のセキュリティ上の懸念点を特定しました：

## 🔐 認証・認可関連

**1. ユーザー認証の欠如**
- Customer（顧客）からの入力に対する認証メカニズムが明示されていない
- 不正なユーザーがシステムにアクセス可能

**2. サービス間認証**
- AWS CloudとAmazon Bedrock、OpenSearch間の認証方式が不明
- 内部サービス間の相互認証が確保されているか不透明

## 🛡️ データ保護関連

**3. データ暗号化**
- 顧客の予約情報やクエリの暗号化状態が不明
- DynamoDBやS3での保存時暗号化の設定が不透明
- 通信経路での暗号化（TLS/SSL）が明示されていない

**4. 個人情報保護**
- 予約データに含まれる個人情報（名前、連絡先等）の保護レベルが不明
- GDPR/個人情報保護法への準拠状況が不透明

## 🌐 ネットワークセキュリティ

**5. ネットワーク分離**
- VPCやセキュリティグループの設定が明示されていない
- パブリックアクセスとプライベートアクセスの境界が不明確

**6. API保護**
- Restaurant assistant agentへのAPI呼び出しに対する保護機能が不明
- レート制限やDDoS対策の有無が不透明

## 💾 データ管理

**7. アクセス制御**
- DynamoDB、S3、OpenSearchへの細かいアクセス権限設定が不明
- 最小権限の原則が適用されているか不明

**8. ログ・監査**
- システム全体の監査ログ取得状況が不明
- セキュリティインシデントの検出・対応体制が見えない

## 🔧 運用面

**9. データ保持期間**
- 顧客データや検索履歴の保持期間ポリシーが不明
- 不要データの自動削除メカニズムが不透明

**10. 障害時の対応**
- セキュリティインシデント発生時のデータ保護手順が不明
- バックアップデータのセキュリティ確保策が見えない

これらの点について、具体的なセキュリティ対策の実装状況を確認し、必要に応じて強化することを推奨します。--- 解析結果 ---
この構成図を分析して、以下のセキュリティ上の懸念点を特定しました：

## 🔐 認証・認可関連

**1. ユーザー認証の欠如**
- Customer（顧客）からの入力に対する認証メカニズムが明示されていない
- 不正なユーザーがシステムにアクセス可能

**2. サービス間認証**
- AWS CloudとAmazon Bedrock、OpenSearch間の認証方式が不明
- 内部サービス間の相互認証が確保されているか不透明

## 🛡️ データ保護関連

**3. データ暗号化**
- 顧客の予約情報やクエリの暗号化状態が不明
- DynamoDBやS3での保存時暗号化の設定が不透明
- 通信経路での暗号化（TLS/SSL）が明示されていない

**4. 個人情報保護**
- 予約データに含まれる個人情報（名前、連絡先等）の保護レベルが不明
- GDPR/個人情報保護法への準拠状況が不透明

## 🌐 ネットワークセキュリティ

**5. ネットワーク分離**
- VPCやセキュリティグループの設定が明示されていない
- パブリックアクセスとプライベートアクセスの境界が不明確

**6. API保護**
- Restaurant assistant agentへのAPI呼び出しに対する保護機能が不明
- レート制限やDDoS対策の有無が不透明

## 💾 データ管理

**7. アクセス制御**
- DynamoDB、S3、OpenSearchへの細かいアクセス権限設定が不明
- 最小権限の原則が適用されているか不明

**8. ログ・監査**
- システム全体の監査ログ取得状況が不明
- セキュリティインシデントの検出・対応体制が見えない

## 🔧 運用面

**9. データ保持期間**
- 顧客データや検索履歴の保持期間ポリシーが不明
- 不要データの自動削除メカニズムが不透明

**10. 障害時の対応**
- セキュリティインシデント発生時のデータ保護手順が不明
- バックアップデータのセキュリティ確保策が見えない

これらの点について、具体的なセキュリティ対策の実装状況を確認し、必要に応じて強化することを推奨します。
```
---
